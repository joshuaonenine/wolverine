$(function(){function e(){$(".block-plan .count").each(function(e){$(this).text(e+1),$(".block-plan .delate").show()})}function t(){var e=$(".block-plan:last");e.find("input:text").not(".default-val").val(""),e.find("select").val("0"),e.find(".txt-error").remove(),e.find("input,select").removeClass("ipt-error")}function n(){var e=$(".block-plan").size();e>11?($(".add-plan").hide(),$(".block-plan:last").css("margin-bottom","40px")):($(".add-plan").show(),$(".block-plan:last").css("margin-bottom","0")),2>e?$(".block-plan .delate").hide():$(".block-plan .delate").show()}function r(){$(".block-remark .count").each(function(e){$(this).text(e+1),$(".block-remark .delate").show()})}function i(){var e=$(".block-remark:last");e.find("input:text").not(".default-val").val(""),e.find("select").val("0"),e.find("input:checkbox").attr("checked",!1),e.find(".txt-error").remove(),e.find("input,select").removeClass("ipt-error")}function o(){var e=$(".block-remark").size();e>2?$(".add-remark").hide():$(".add-remark").show(),2>e?$(".block-remark .delate").hide():($(".block-remark .delate").show(),$(".block-remark:first .delate").hide())}function a(){$(".block-agreement .count").each(function(e){$(this).text(e+1),$(".block-agreement .delate").show()})}function s(){var e=$(".block-agreement:last");e.find("input:text").val(""),e.find("select").val("0"),e.find(".txt-error").remove(),e.find("input,select").removeClass("ipt-error")}function l(){var e=$(".block-agreement").size();e>2?($(".add-agreement").hide(),$(".block-agreement:last").css("margin-bottom","40px")):($(".add-agreement").show(),$(".block-agreement:last").css("margin-bottom","0")),2>e?$(".block-agreement .delate").hide():$(".block-agreement .delate").show()}function u(){$("select,input,label").removeClass("ipt-error"),$(".txt-error").remove()}$(document).on("keypress","input:not(.allow_submit)",function(e){return 13!==e.which}),$(".block-link").click(function(){location.href=$(this).find("a").attr("href")}),$(".is-num").each(function(){$(this).blur(function(){$(this).removeClass("ipt-error"),$(this).parent().find(".txt-error").remove(),$(this).parents("form").find("button:submit").attr("disabled",!1);var e=$(this).val();""==e||e.match(/^[0-9]+$/)||($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">\u534a\u89d2\u6570\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'),$(this).parents("form").find("button:submit").attr("disabled",!0))})}),$("#submit-create").on("click",function(){function e(){$("select").removeClass("ipt-error"),$(".txt-error").remove()}if(e(),$(".s-required").each(function(){"0"==$(this).val()&&($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'))}),"0"!=$(".ipt-error").size())return!1;e();var t=$("#entry-category").find(":selected").data("action");$("#entry-form").attr("action",t)}),$(".add-btn").click(function(){var u=$(this).data("type");"plan"==u?($(".block-plan:first").clone(!0).insertBefore(this),e(),t(),n()):"remark"==u?($(".block-remark:first").clone(!0).insertBefore(this),r(),i(),o(),$(".block-remark").not(":first").find(".clone-hide").remove()):"agreement"==u&&($(".block-agreement:first").clone(!0).insertBefore(this),a(),s(),l())}),$(".delate").on("click",function(){var t=$(this).data("type");$(this).parents(".block-clone").remove(),"plan"==t?(e(),n()):"remark"==t?(r(),o()):"agreement"==t&&(a(),l())}),$(".btn-validate").click(function(){u(),$(".t-required:visible").each(function(){$(this).val()||$(this).addClass("ipt-error")}),$(".s-required:visible").each(function(){"0"==$(this).val()&&$(this).addClass("ipt-error")}),$(".block-default:visible td").find(".ipt-error:first").parent().append('<p class="txt-error">\u5fc5\u9808\u9805\u76ee\u3067\u3059</p>'),$(".num-validate:visible").each(function(){""!=$(this).val()&&$(this).val().match(/[^0-9]+/)&&($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">\u534a\u89d2\u6570\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'),$(this).parent().find(".txt-error").size()>1&&$(this).parent().find(".txt-error:last").remove())}),$(".kana-validate:visible").each(function(){""==$(this).val()||$(this).val().match(/^[\uff67-\uff9d\uff9e\uff9f ]*$/)||($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">\u534a\u89d2\u30ab\u30ca\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'))}),$(".max-3:visible").each(function(){var e=$(this).val().length;""!=e&&e>3&&($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">3\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'))}),$(".max-4:visible").each(function(){var e=$(this).val().length;""!=e&&e>4&&($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">4\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'))}),$(".max-100:visible").each(function(){var e=$(this).val().length;""!=e&&e>100&&($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">100\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'))});var e=$(".ipt-error").size();return e>0?($("html,body").animate({scrollTop:$(".ipt-error:first").offset().top-30},600),!1):void 0}),$(".btn-submit").click(function(){u(),$(".t-required:visible").each(function(){$(this).val()||($(this).addClass("ipt-error"),$(this).parent().append('<p class="txt-error">\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</p>'))}),$(".file-required:visible").each(function(){$(this).val()||($(this).addClass("ipt-error"),$(this).after('<p class="txt-error">\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044</p>'))});var e=$(".ipt-error").size();return e>0?!1:void 0})});